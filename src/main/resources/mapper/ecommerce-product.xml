<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jojo.ecommerce.adapter.out.persistence.ProductMapper">

    <resultMap id="ProductMap" type="com.jojo.ecommerce.domain.model.Product">
        <id column="product_id"    property="productId"/>
        <result column="product_name"  property="productName"/>
        <result column="stock"         property="stock"/>
        <result column="product_price" property="productPrice"/>
        <result column="product_code"  property="productCode"/>
        <result column="reg_date"      property="regDate"/>
        <result column="upd_date"      property="updDate"/>
    </resultMap>

    <select id="selectProductById" resultMap="ProductMap" parameterType="long">
        SELECT
            product_id
          , product_name
          , stock
          , product_price
          , product_code
          , reg_date
          , upd_date
        FROM product
        WHERE product_id = #{productId}
        FOR UPDATE
    </select>

    <select id="selectAllProducts" resultMap="ProductMap">
        SELECT
            product_id
          , product_name
          , stock
          , product_price
          , product_code
          , reg_date
          , upd_date
        FROM product
    </select>

    <insert id="insertProduct" parameterType="com.jojo.ecommerce.domain.model.Product" useGeneratedKeys="true" keyProperty="productId">
        INSERT INTO product (
            product_name
          , stock
          , product_price
          , product_code
          , reg_date
        ) VALUES (
           #{productName}
         , #{stock}
         , #{productPrice}
         , #{productCode}
         , NOW()
        )
    </insert>

    <update id="updateProduct" parameterType="com.jojo.ecommerce.domain.model.Product">
        UPDATE product
        SET
           stock = #{stock}
        WHERE product_id = #{productId}
    </update>

</mapper>
